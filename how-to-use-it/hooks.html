<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hooks | Krawler</title>
    <meta name="description" content="A minimalist Geospatial ETL">
    <link rel="icon" href="https://s3.eu-central-1.amazonaws.com/kalisioscope/krawler/krawler-icon-64x64.png">
  <link rel="manifest" href="/krawler/manifest.json">
    
    <link rel="preload" href="/krawler/assets/css/11.styles.25115a71.css" as="style"><link rel="preload" href="/krawler/assets/js/app.87c66467.js" as="script"><link rel="preload" href="/krawler/assets/js/4.b5cccee6.js" as="script"><link rel="prefetch" href="/krawler/assets/js/6.908abf6f.js"><link rel="prefetch" href="/krawler/assets/js/0.194c5bc7.js"><link rel="prefetch" href="/krawler/assets/js/1.6aa2d1ee.js"><link rel="prefetch" href="/krawler/assets/js/2.1c1fcd6e.js"><link rel="prefetch" href="/krawler/assets/js/3.6f419f06.js"><link rel="prefetch" href="/krawler/assets/js/5.43f8fc16.js"><link rel="prefetch" href="/krawler/assets/js/7.674fd476.js"><link rel="prefetch" href="/krawler/assets/js/8.74be0555.js"><link rel="prefetch" href="/krawler/assets/js/9.4c9540ef.js"><link rel="prefetch" href="/krawler/assets/js/10.5846d16f.js">
    <link rel="stylesheet" href="/krawler/assets/css/11.styles.25115a71.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/krawler/" class="home-link router-link-active"><!----><span class="site-name">
      Krawler
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/krawler/what-is-it/" class="nav-link">What is it ?</a></div><div class="nav-item"><a href="/krawler/how-does-it-work/" class="nav-link">How doest it work ?</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">How to use it ?</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/installation.html" class="nav-link">Installation</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/cli.html" class="nav-link">CLI</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/services.html" class="nav-link">Services</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/hooks.html" class="nav-link router-link-exact-active router-link-active">Hooks</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/extending.html" class="nav-link">Extending</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/examples.html" class="nav-link">Examples</a></li></ul></div></div><div class="nav-item"><a href="/krawler/license/" class="nav-link">License</a></div><div class="nav-item"><a href="https://github.com/kalisio/krawler" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/krawler/what-is-it/" class="nav-link">What is it ?</a></div><div class="nav-item"><a href="/krawler/how-does-it-work/" class="nav-link">How doest it work ?</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">How to use it ?</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/installation.html" class="nav-link">Installation</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/cli.html" class="nav-link">CLI</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/services.html" class="nav-link">Services</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/hooks.html" class="nav-link router-link-exact-active router-link-active">Hooks</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/extending.html" class="nav-link">Extending</a></li><li class="dropdown-item"><!----><a href="/krawler/how-to-use-it/examples.html" class="nav-link">Examples</a></li></ul></div></div><div class="nav-item"><a href="/krawler/license/" class="nav-link">License</a></div><div class="nav-item"><a href="https://github.com/kalisio/krawler" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><p align="center"><a href="https://kalisio.com"><img src="https://s3.eu-central-1.amazonaws.com/kalisioscope/kalisio/kalisio-logo-black-256x84.png"></a><br><i><small>Unleashing the potential of spatial information</small></i></p><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Hooks</span><!----></p><ul class="sidebar-group-items"><li><a href="/krawler/how-to-use-it/hooks.html#common-options" class="sidebar-link">Common options</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#authentication-source" class="sidebar-link">Authentication source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#basicauth-options" class="sidebar-link">basicAuth(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#clearing-source" class="sidebar-link">Clearing source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#clearoutputs-options" class="sidebar-link">clearOutputs(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#cleardata-options" class="sidebar-link">clearData(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#csv-source" class="sidebar-link">CSV source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#readcsv-options" class="sidebar-link">readCSV(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writecsv-options" class="sidebar-link">writeCSV(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#mergecsv-options" class="sidebar-link">mergeCSV(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#geographic-grid-source" class="sidebar-link">Geographic grid source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#generategrid-options" class="sidebar-link">generateGrid(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#generategridtasks-options" class="sidebar-link">generateGridTasks(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#json-source" class="sidebar-link">JSON source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#readjson-options" class="sidebar-link">readJson(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writejson-options" class="sidebar-link">writeJson(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#transformjson-options" class="sidebar-link">transformJson(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#mergejson-options" class="sidebar-link">mergeJson(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writetemplate-options" class="sidebar-link">writeTemplate(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#converttogeojson-options" class="sidebar-link">convertToGeoJson(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#geojson-source" class="sidebar-link">GeoJSON source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#reprojectgeojson-options" class="sidebar-link">reprojectGeoJson(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#mongodb-source" class="sidebar-link">MongoDB source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#connectmongo-options" class="sidebar-link">connectMongo(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#disconnectmongo-options" class="sidebar-link">disconnectMongo(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#dropmongocollection-options" class="sidebar-link">dropMongoCollection(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#createmongocollection-options" class="sidebar-link">createMongoCollection(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writemongocollection-options" class="sidebar-link">writeMongoCollection(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#ogc-source" class="sidebar-link">OGC source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#getcapabilities-options" class="sidebar-link">getCapabilities(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#postgresql-source" class="sidebar-link">PostgreSQL source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#connectpg-options" class="sidebar-link">connectPG(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#disconnectpg-options" class="sidebar-link">disconnectPG(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#droppgtable-options" class="sidebar-link">dropPGTable(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#createpgtable-options" class="sidebar-link">createPGTable(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writepgtable-options" class="sidebar-link">writePGTable(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#raster-source" class="sidebar-link">Raster source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#readgeotiff-options" class="sidebar-link">readGeoTiff(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#computestatistics-options" class="sidebar-link">computeStatistics(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#store-source" class="sidebar-link">Store source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#createstores-options" class="sidebar-link">createStores(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#removestores-options" class="sidebar-link">removeStores(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#system-source" class="sidebar-link">System source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#tar-options" class="sidebar-link">tar(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#untar-options" class="sidebar-link">untar(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#runcommand-options" class="sidebar-link">runCommand(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#createcontainer-options" class="sidebar-link">createContainer(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#runcontainercommand-options" class="sidebar-link">runContainerCommand(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#xml-source" class="sidebar-link">XML source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#readxml-options" class="sidebar-link">readXML(options)</a></li></ul></li><li><a href="/krawler/how-to-use-it/hooks.html#yaml-source" class="sidebar-link">YAML source</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#readyaml-options" class="sidebar-link">readYAML(options)</a></li><li class="sidebar-sub-header"><a href="/krawler/how-to-use-it/hooks.html#writeyaml-options" class="sidebar-link">writeYAML(options)</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks</h1><h2 id="common-options"><a href="#common-options" aria-hidden="true" class="header-anchor">#</a> Common options</h2><p>All hooks can have the following options:</p><ul><li><strong>match</strong>: a match filter to be applied on the input hook data using any option supported by <a href="https://github.com/crcn/sift.js" target="_blank" rel="noopener noreferrer">sift<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, if the data is filtered the hook will not be applied</li><li><strong>faultTolerant</strong>: will catch any error raised in the hook so that the hook chain will continue anyway</li></ul><blockquote><p>Matching is for instance useful when you'd like to apply a hook to only a subset of your tasks, e.g. all the CSV files but not the JSON files.</p></blockquote><blockquote><p>Fault tolerance is for instance useful when you use unreliable data sources and you don't want the job to stop when some requests fail.</p></blockquote><p>All input/output hooks, i.e. reading/writing/removing data in a store like <code>readJson</code> or <code>writeJson</code>, can have the following options:</p><ul><li><strong>storePath</strong>: property path where to read the store to be used on the hook object or params, defaults to <code>data.store</code></li><li><strong>store</strong>: property containing the ID of the store to be used, not defined by default</li><li><strong>storageOptions</strong>: write options for the underlying store</li></ul><h2 id="authentication-source"><a href="#authentication-source" aria-hidden="true" class="header-anchor">#</a> Authentication <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.auth.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="basicauth-options"><a href="#basicauth-options" aria-hidden="true" class="header-anchor">#</a> basicAuth(options)</h3><p>Add headers to HTTP requests for basic authorization, hook options are the following:</p><ul><li><strong>type</strong>: type of authorization used as the key in the header, defaults to <code>Authorization</code> but could be changed to <code>Proxy-Authorization</code> for instance</li><li><strong>optionsPath</strong>: the property path to the request options that contains the authorization options, defaults to <code>options</code></li></ul><p>The authorization options have to be structured like this, e.g. on a task (or similarly on a task template in a job):</p><div class="language-js extra-class"><pre class="language-js"><code>httpTask<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">:</span> <span class="token string">'http'</span><span class="token punctuation">,</span>
  options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    url<span class="token punctuation">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
    auth<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      user<span class="token punctuation">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
      password<span class="token punctuation">:</span> <span class="token string">'xxx'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="clearing-source"><a href="#clearing-source" aria-hidden="true" class="header-anchor">#</a> Clearing <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.clear.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="clearoutputs-options"><a href="#clearoutputs-options" aria-hidden="true" class="header-anchor">#</a> clearOutputs(options)</h3><p>Clear output files generated by tasks and hooks, hook options are the following:</p><ul><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>type</strong>: the type of output to be cleared by this hook, defaults to <code>intermediate</code></li></ul><h3 id="cleardata-options"><a href="#cleardata-options" aria-hidden="true" class="header-anchor">#</a> clearData(options)</h3><p>Clear output data generated by hooks, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path to clean on the hook object, defaults to <code>result.data</code></li></ul><blockquote><p>Use this hook if you load large datasets (e.g. JSON files) because all hook data are still referenced in memory until the job is finished</p></blockquote><h2 id="csv-source"><a href="#csv-source" aria-hidden="true" class="header-anchor">#</a> CSV <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.csv.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="readcsv-options"><a href="#readcsv-options" aria-hidden="true" class="header-anchor">#</a> readCSV(options)</h3><p>Read a CSV from an input stream/store and convert it to in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li>any option supported by <a href="https://github.com/C2FO/fast-csv#parsing" target="_blank" rel="noopener noreferrer">fast-csv<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h3 id="writecsv-options"><a href="#writecsv-options" aria-hidden="true" class="header-anchor">#</a> writeCSV(options)</h3><p>Generate a CSV file from in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>result</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li><li>any option supported by <a href="https://github.com/C2FO/fast-csv#parsing" target="_blank" rel="noopener noreferrer">fast-csv<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h3 id="mergecsv-options"><a href="#mergecsv-options" aria-hidden="true" class="header-anchor">#</a> mergeCSV(options)</h3><p>Generate a CSV file from a set of input CSV files, hook options are the following:</p><ul><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li><li>any option supported by <a href="https://github.com/C2FO/fast-csv#parsing" target="_blank" rel="noopener noreferrer">fast-csv<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>The input hook result is expected to be an array of tasks which output will be read back from the store.</p><h2 id="geographic-grid-source"><a href="#geographic-grid-source" aria-hidden="true" class="header-anchor">#</a> Geographic grid <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.grid.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="generategrid-options"><a href="#generategrid-options" aria-hidden="true" class="header-anchor">#</a> generateGrid(options)</h3><p>Generate geographic grid parameters from an input location (grid center), area width and resolution. Required input hook data are the following:</p><ul><li><strong>longitude</strong>: grid center longitude (in degrees)</li><li><strong>latitude</strong>: grid center latitude (in degrees)</li><li><strong>resolution</strong>: grid cell resolution (in meters)</li><li><strong>halfWidth</strong>: grid half-width (in meters)</li><li><strong>blockResolution</strong>: grid block resolution (in meters)</li></ul><p>Output hook data are the following:</p><ul><li><strong>origin</strong>: grid bounding box minimum longitude and latitude (in degrees)</li><li><strong>size</strong>: number of grid cells in longitude and latitude</li><li><strong>resolution</strong>: grid cell resolution (in degrees) for longitude and latitude</li><li><strong>nbBlocks</strong>: number of grid blocks in longitude and latitude</li><li><strong>blockSize</strong>: number of grid cells in longitude and latitude within each block</li><li><strong>blockResolution</strong>: grid block resolution (in degrees) for longitude and latitude</li></ul><blockquote><p>This hook works only for EPSG 4326</p></blockquote><h3 id="generategridtasks-options"><a href="#generategridtasks-options" aria-hidden="true" class="header-anchor">#</a> generateGridTasks(options)</h3><p>Generate WMS/WCS request tasks to download data for each cell of a geographic grid (see previous hook for grid definition). It is intended to be used a a job hook and the required input data on the task template are the following:</p><ul><li><strong>type</strong>: task type (either <code>wms</code>or <code>wcs</code>)</li><li><strong>options.version</strong>: WMS/WCS service version</li><li><strong>options.longitudeLabel</strong>: name of the longitude axis in WCS service</li><li><strong>options.latitudeLabel</strong>: name of the latitude axis in WCS service</li></ul><blockquote><p>This hook works only for EPSG 4326</p></blockquote><h2 id="json-source"><a href="#json-source" aria-hidden="true" class="header-anchor">#</a> JSON <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.json.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="readjson-options"><a href="#readjson-options" aria-hidden="true" class="header-anchor">#</a> readJson(options)</h3><p>Read a JSON from an input stream/store and convert it to in-memory JSON values, hook options are the following:</p><ul><li><strong>objectPath</strong>: property path where to read the JSON object in the JSON coming from the store, not defined by default so that the whole JSON is retrieved</li><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li></ul><h3 id="writejson-options"><a href="#writejson-options" aria-hidden="true" class="header-anchor">#</a> writeJson(options)</h3><p>Generate a JSON file from in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>result</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li></ul><h3 id="transformjson-options"><a href="#transformjson-options" aria-hidden="true" class="header-anchor">#</a> transformJson(options)</h3><p>Restructure in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>transformPath</strong>: property path where to read/write the JSON part to be transformed in the input JSON object, if not given use the input JSON</li><li><strong>toArray</strong>: boolean indicating if the JSON object will be transformed into an array using <a href="https://lodash.com/docs#toArray" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, defaults to <code>false</code></li><li><strong>toObjects</strong>: if your input JSON objects are flat arrays it will be transformed into objects according to the given indexed list of property names to be used as keys, not defined by default</li><li><strong>filter</strong>: a filter to be applied on the JSON object using any option supported by <a href="https://github.com/crcn/sift.js" target="_blank" rel="noopener noreferrer">sift<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>mapping</strong>: a map between input key path and output key path supporting dot notation, the values of the map can also be a structure like this:
<ul><li><strong>path</strong>: output key path</li><li><strong>value</strong>: a map between input values and output values</li><li><strong>delete</strong>: boolean indicating if the input key path should be deleted or not after mapping</li></ul></li><li><strong>unitMapping</strong>: a map between input key path supporting dot notation and from/to units to convert using <a href="http://mathjs.org/docs/datatypes/units.html" target="_blank" rel="noopener noreferrer">math.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for numbers or <a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">moment.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for dates, a value of the map is a structure like this:
<ul><li><strong>from</strong>: the unit or date format to convert from, e.g. <code>feet</code> or <code>YYYY-MM-DD HH:mm:ss.SSS</code></li><li><strong>to</strong>: the unit or date format to convert to, e.g. <code>m</code> or <code>MM-DD-YYYY HH:mm:ss.SSS</code>, if given for a date the date object will be converted back to string</li><li><strong>asDate</strong>: mandatory to indicate if the value is a date, could be <code>utc</code> or <code>local</code> to interpret it as UTC or Local Time</li></ul></li><li><strong>pick</strong>: an array of properties to be picked using <a href="https://lodash.com/docs#pick" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>omit</strong>: an array of properties to be omitted using <a href="https://lodash.com/docs#omit" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>merge</strong>: an object to be merged with each JSON objects using <a href="https://lodash.com/docs#merge" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>Example:</p><div class="language-js extra-class"><pre class="language-js"><code>toArray<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// The following input object { 1: { property: 'a' }, 2: { property: 'b' } } will be transformed into [{ property: 'a' }, { property: 'b' }]</span>
toObjects<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// The following input object ['a', 'b'] will be transformed into { 1: 'a', 2: 'b' }</span>
mapping<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  sourceProperty<span class="token punctuation">:</span> <span class="token string">'targetProperty'</span><span class="token punctuation">,</span>
  sourceProperty<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> <span class="token string">'targetProperty'</span><span class="token punctuation">,</span>
    values<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token string">'c'</span> <span class="token comment">// Will map { xxx: 'a' } to { yyy: 'c' }</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'source.property'</span><span class="token punctuation">:</span> <span class="token string">'target.property'</span><span class="token punctuation">,</span>
  sourceProperty<span class="token punctuation">:</span> <span class="token string">'targetArrayProperty[0]'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
unitMapping<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  property<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'feet'</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token string">'m'</span> <span class="token punctuation">}</span> <span class="token comment">// This one will be converted from feet to meters</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
pick<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'onlyThisPropertyWillBeKept'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
omit<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'onlyThisPropertyWillBeRemoved'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
merge<span class="token punctuation">:</span> <span class="token punctuation">{</span> newProperty<span class="token punctuation">:</span> <span class="token string">'will be added to the final objects'</span> <span class="token punctuation">}</span>
</code></pre></div><blockquote><p>The transformations are applied in the order of the documentation, e.g. filtering occurs before mapping.</p></blockquote><h3 id="mergejson-options"><a href="#mergejson-options" aria-hidden="true" class="header-anchor">#</a> mergeJson(options)</h3><p>Generate a in-memory JSON object from a set of input in-memory JSON objects, hook options are the following:</p><ul><li><strong>by</strong>: property name to be used as a unique identifier to perform merging using <a href="https://lodash.com/docs#unionBy" target="_blank" rel="noopener noreferrer">Lodash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>dataPath</strong>: property path where to read the input JSON object on the result hook objects, defaults to <code>data</code></li></ul><p>The input hook result is expected to be an array of tasks which output will be read in-memory.</p><h3 id="writetemplate-options"><a href="#writetemplate-options" aria-hidden="true" class="header-anchor">#</a> writeTemplate(options)</h3><p>Generate a file from an input template and injected in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>templateStorePath</strong>: property path where to read the store to be used for reading template on the hook object or params, defaults to <code>data.templateStore</code></li><li><strong>templateStore</strong>: property containing the ID of the store to be used for reading template, not defined by default</li><li><strong>templateFile</strong>: file name of the template file to be used</li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li></ul><blockquote><p>Learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="converttogeojson-options"><a href="#converttogeojson-options" aria-hidden="true" class="header-anchor">#</a> convertToGeoJson(options)</h3><p>Convert in-memory JSON values to a <a href="https://fr.wikipedia.org/wiki/GeoJSON" target="_blank" rel="noopener noreferrer">GeoJSON<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> collection. For each in-memory object, the hook generates a corresponding GeoJSON feature using specific properties to build the <code>geometry</code> property. For now, it only allows to generate features of type of <code>Point</code>. Moreover, the coordinate reference system is a geographic coordinate reference system, using the World Geodetic System 1984 (WGS 84), with longitude and latitude expressed in decimal degrees. The entire object is stored under the <code>properties</code> property of the feature.
Hook options are the following:</p><ul><li><strong>longitude</strong>: property path where to read the longitude value defaults to <code>longitude</code></li><li><strong>latitude</strong>: property path where to read the latitude value defaults to <code>latitude</code></li><li><strong>altitude</strong>: property path where to read the altitude value defaults to <code>altitude</code></li><li><strong>keepGeometryProperties</strong>: boolean indicating if longitude, latitude and altitude values are also kept as properties, defaults to <code>true</code></li></ul><h2 id="geojson-source"><a href="#geojson-source" aria-hidden="true" class="header-anchor">#</a> GeoJSON <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.geojson.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="reprojectgeojson-options"><a href="#reprojectgeojson-options" aria-hidden="true" class="header-anchor">#</a> reprojectGeoJson(options)</h3><p>Reproject a GeoJSON from a given projection system to another one, hook options are the following:</p><ul><li><strong>from</strong>: EPSG code of the input projection, defaults to <code>EPSG:4326</code></li><li><strong>to</strong>: EPSG code of the output projection, defaults to <code>EPSG:4326</code></li><li><strong>dataPath</strong>: property path where to store the resulting GeoJSON object on the hook object, defaults to <code>result.data</code></li></ul><h2 id="mongodb-source"><a href="#mongodb-source" aria-hidden="true" class="header-anchor">#</a> MongoDB <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.mongo.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="connectmongo-options"><a href="#connectmongo-options" aria-hidden="true" class="header-anchor">#</a> connectMongo(options)</h3><p>Connect to a MongoDB database. The <a href="http://mongodb.github.io/node-mongodb-native/3.0/api/MongoClient.html#.connect" target="_blank" rel="noopener noreferrer">connection options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of the client are defined in the hook options plus:</p><ul><li><strong>url</strong>: MongoDB <a href="https://docs.mongodb.com/manual/reference/connection-string/" target="_blank" rel="noopener noreferrer">URI connection string<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>dbName</strong>: the name of the DB to connect to</li><li><strong>clientPath</strong>: property path where to store the client object to be used by the MongoDB hooks, defaults to <code>client</code></li></ul><h3 id="disconnectmongo-options"><a href="#disconnectmongo-options" aria-hidden="true" class="header-anchor">#</a> disconnectMongo(options)</h3><p>Disconnect from a MongoDB database. Hook options are the following:</p><ul><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="dropmongocollection-options"><a href="#dropmongocollection-options" aria-hidden="true" class="header-anchor">#</a> dropMongoCollection(options)</h3><p>Drop if exists a collection in a MongoDB database. Hook options are the following:</p><ul><li><strong>collection</strong>: the name of the collection to be removed, defaults to the hook object ID</li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="createmongocollection-options"><a href="#createmongocollection-options" aria-hidden="true" class="header-anchor">#</a> createMongoCollection(options)</h3><p>Create a collection in a MongoDB database. Hook options are the following:</p><ul><li><strong>collection</strong>: the name of the collection to be created, defaults to the hook object ID</li><li><strong>index</strong>: the <a href="https://docs.mongodb.com/manual/indexes/#create-an-index" target="_blank" rel="noopener noreferrer">specification of the index<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> associated to the collection</li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="writemongocollection-options"><a href="#writemongocollection-options" aria-hidden="true" class="header-anchor">#</a> writeMongoCollection(options)</h3><p>Inserts a GeoJSON collection or an array of features into an existing collection. Hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>data.result</code></li><li><strong>chunkSize</strong>: number of GeoJson features for the <a href="https://docs.mongodb.com/manual/reference/method/db.collection.bulkWrite/" target="_blank" rel="noopener noreferrer">batch insert<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h2 id="ogc-source"><a href="#ogc-source" aria-hidden="true" class="header-anchor">#</a> OGC <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.ogc.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="getcapabilities-options"><a href="#getcapabilities-options" aria-hidden="true" class="header-anchor">#</a> getCapabilities(options)</h3><p>Execute a <code>GetCapabilties</code> request to get the general information about an OGC service such as WMS, WCS, WPS...
Hook options are the following:</p><ul><li><strong>url</strong>: the bas url of the request to be executed</li><li><strong>service</strong>: the service to request</li><li><strong>token</strong>: an access token if required by the server</li><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li></ul><p>The following example illustrates how to use this hook:</p><div class="language- extra-class"><pre class="language-text"><code>getCapabilities: {
  url: 'http://geoserver.kalisio.xyz/geoserver/Kalisio/wms',
  service: 'WMS'
}
</code></pre></div><h2 id="postgresql-source"><a href="#postgresql-source" aria-hidden="true" class="header-anchor">#</a> PostgreSQL <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.pg.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="connectpg-options"><a href="#connectpg-options" aria-hidden="true" class="header-anchor">#</a> connectPG(options)</h3><p>Connect to a PostgreSQL database. The <a href="https://node-postgres.com/api/client" target="_blank" rel="noopener noreferrer">connection options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of the client are defined in the hook options plus:</p><ul><li><strong>clientPath</strong>: property path where to store the client object to be used by the PostgreSQL hooks, defaults to <code>client</code></li></ul><p>Also, this hook allows you to use the same environment variables as <a href="https://node-postgres.com/features/connecting" target="_blank" rel="noopener noreferrer">node-postgres<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to store the connection information:</p><ul><li><code>PGUSER=dbuser</code></li><li><code>PGPASSWORD=secretpassword</code></li><li><code>PGHOST=database.server.com</code></li><li><code>PGPORT=5432</code></li><li><code>PGDATABASE=database</code></li></ul><p>Finaly and for some security reason, it is highly recommended to combine both ways such as in the following example:</p><div class="language- extra-class"><pre class="language-text"><code>connectPG: {
  user: process.env.PG_USER,
  password: process.env.PG_PASSWORD,
  host: 'localhost',
  database: 'test',
  port: 5432,
  clientPath: 'taskTemplate.client'
}
</code></pre></div><h3 id="disconnectpg-options"><a href="#disconnectpg-options" aria-hidden="true" class="header-anchor">#</a> disconnectPG(options)</h3><p>Disconnect from a PostgresSQL database. Hook options are the following:</p><ul><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="droppgtable-options"><a href="#droppgtable-options" aria-hidden="true" class="header-anchor">#</a> dropPGTable(options)</h3><p>Drop if exists a table in a PostgreSQL database. Hook options are the following:</p><ul><li><strong>table</strong>: the name of the table to be removed, defaults to the hook object ID</li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="createpgtable-options"><a href="#createpgtable-options" aria-hidden="true" class="header-anchor">#</a> createPGTable(options)</h3><p>Create a table in a PostgreSQL database with the following structure:</p><ul><li><code>id</code>: a SERIAL (primary key)</li><li><code>geom</code>: a PostGIS geometry of type of <code>POINTZ</code> expressed in Geodetic reference system.</li><li><code>properties</code>: an object of type of JSON.</li></ul><blockquote><p>For now the structure has been defined to store GeoJSON collection.
Hook options are the following:</p></blockquote><ul><li><strong>table</strong>: the name of the table to be created, defaults to the hook object ID</li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h3 id="writepgtable-options"><a href="#writepgtable-options" aria-hidden="true" class="header-anchor">#</a> writePGTable(options)</h3><p>Inserts a GeoJSON collection or an array of features into an existing table. THe table must have the same structured as a table created using the <strong>createPGTable</strong> hook.
Hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>data.result</code></li><li><strong>chunkSize</strong>: number of GeoJson features for the batch insert</li><li><strong>clientPath</strong>: property path where to retrieve the client object, defaults to <code>client</code></li></ul><h2 id="raster-source"><a href="#raster-source" aria-hidden="true" class="header-anchor">#</a> Raster <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.raster.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="readgeotiff-options"><a href="#readgeotiff-options" aria-hidden="true" class="header-anchor">#</a> readGeoTiff(options)</h3><p>Read a GeoTiff from an input stream/store and convert it to in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>fields</strong>: set of fields to be exported for each cell, if empty values will be directly exported as a JSON array, otherwise fields among the following can be selected
<ul><li><strong>x</strong>: pixel x-coordinate</li><li><strong>y</strong>: pixel y-coordinate</li><li><strong>bbox</strong>: pixel bounding box</li><li><strong>value</strong>: pixel value</li></ul></li></ul><h3 id="computestatistics-options"><a href="#computestatistics-options" aria-hidden="true" class="header-anchor">#</a> computeStatistics(options)</h3><p>Computes minimum and maximum values on a GeoTiff file, hook options are the following:</p><ul><li><strong>min</strong>: boolean indicating if minimum value should be computed</li><li><strong>max</strong>: boolean indicating if maximum value should be computed</li><li><strong>statisticsPath</strong>: property path where to write the output statistics on the hook object, defaults to <code>result</code></li></ul><h2 id="store-source"><a href="#store-source" aria-hidden="true" class="header-anchor">#</a> Store <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.store.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="createstores-options"><a href="#createstores-options" aria-hidden="true" class="header-anchor">#</a> createStores(options)</h3><p>Create (a set of) store(s), hook options are the (array of) following the following:</p><ul><li>any option supported by the <a href="./SERVICES#stores">stores service</a></li><li><strong>storePath</strong>: property path where to set the created store on the hook object, if not given the store will be created through the service but not stored on the hook</li></ul><h3 id="removestores-options"><a href="#removestores-options" aria-hidden="true" class="header-anchor">#</a> removeStores(options)</h3><p>Remove (a set of) store(s), hook options are (array of) the following:</p><ul><li><strong>id</strong>: the store ID</li><li><strong>storePath</strong>: property path where to unset the removed store on the hook object, if not given the store will be removed through service but not on the hook</li></ul><blockquote><p>As a shortcut the options provided can only be store IDs when <strong>storePath</strong> is not used</p></blockquote><h2 id="system-source"><a href="#system-source" aria-hidden="true" class="header-anchor">#</a> System <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.system.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="tar-options"><a href="#tar-options" aria-hidden="true" class="header-anchor">#</a> tar(options)</h3><p>Tar files or directories using <a href="https://github.com/npm/node-tar" target="_blank" rel="noopener noreferrer">node-tar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, hook options are the following:</p><ul><li><strong>files</strong>: array of paths to add to the tarball</li><li>any option supported by node-tar for <a href="https://github.com/npm/node-tar#tarcoptions-filelist-callback-alias-tarcreate" target="_blank" rel="noopener noreferrer">packing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><blockquote><p><code>file</code>, <code>files</code> and <code>cwd</code> options can be templates, learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="untar-options"><a href="#untar-options" aria-hidden="true" class="header-anchor">#</a> untar(options)</h3><p>Untar files or directories using <a href="https://github.com/npm/node-tar" target="_blank" rel="noopener noreferrer">node-tar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, hook options are the following:</p><ul><li><strong>files</strong>: array of paths to extract from the tarball</li><li>any option supported by node-tar for <a href="https://github.com/npm/node-tar#tarxoptions-filelist-callback-alias-tarextract" target="_blank" rel="noopener noreferrer">unpacking<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><blockquote><p><code>file</code>, <code>files</code> and <code>cwd</code> options can be templates, learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="runcommand-options"><a href="#runcommand-options" aria-hidden="true" class="header-anchor">#</a> runCommand(options)</h3><p>Run a system command, hook options are the following:</p><ul><li><strong>command</strong>: the template of the command to be run with the hook object as context</li><li><strong>stdout</strong>: boolean indicating if stdout is logged and stored in the hook object</li><li><strong>stderr</strong>: boolean indicating if stderr is logged and stored in the hook object</li></ul><blockquote><p>Learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="createcontainer-options"><a href="#createcontainer-options" aria-hidden="true" class="header-anchor">#</a> createContainer(options)</h3><p>Run a docker container using <a href="https://github.com/apocas/dockerode" target="_blank" rel="noopener noreferrer">dockerode<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, hook options are the following:</p><ul><li>any option supported by dockerode for <a href="https://github.com/apocas/dockerode#getting-started" target="_blank" rel="noopener noreferrer">connection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://github.com/apocas/dockerode#manipulating-a-container" target="_blank" rel="noopener noreferrer">creation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><blockquote><p><code>Cmd</code> and <code>Env</code> options can be templates, learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h3 id="runcontainercommand-options"><a href="#runcontainercommand-options" aria-hidden="true" class="header-anchor">#</a> runContainerCommand(options)</h3><p>Run a command against a docker container using <a href="https://github.com/apocas/dockerode" target="_blank" rel="noopener noreferrer">dockerode<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, hook options are the following:</p><ul><li><strong>command</strong>: the name of the command to be run</li><li><strong>arguments</strong>: the arguments of the command to be run
<ul><li>support any command/option supported by dockerode on <a href="https://github.com/apocas/dockerode#manipulating-a-container" target="_blank" rel="noopener noreferrer">containers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul><p>When the <code>getArchive</code> command is used, additional hook options are the following:</p><ul><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li></ul><blockquote><p><code>Cmd</code>, <code>Env</code> and <code>path</code> options can be templates, learn more about <a href="https://lodash.com/docs/4.17.4#template" target="_blank" rel="noopener noreferrer">templating<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><blockquote><p>The hook take care to wait for <code>exec</code> to finish and automatically write the tar in the hook store for <code>getArchive</code></p></blockquote><h2 id="xml-source"><a href="#xml-source" aria-hidden="true" class="header-anchor">#</a> XML <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.xml.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="readxml-options"><a href="#readxml-options" aria-hidden="true" class="header-anchor">#</a> readXML(options)</h3><p>Read an XML file from a store and convert it to in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li></ul><h2 id="yaml-source"><a href="#yaml-source" aria-hidden="true" class="header-anchor">#</a> YAML <a href="https://github.com/kalisio/krawler/blob/master/src/hooks/hooks.yaml.js" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h3 id="readyaml-options"><a href="#readyaml-options" aria-hidden="true" class="header-anchor">#</a> readYAML(options)</h3><p>Read a YAML file from a store and convert it to in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to store the resulting JSON object on the hook object, defaults to <code>result.data</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li></ul><h3 id="writeyaml-options"><a href="#writeyaml-options" aria-hidden="true" class="header-anchor">#</a> writeYAML(options)</h3><p>Generate a YAML file from in-memory JSON values, hook options are the following:</p><ul><li><strong>dataPath</strong>: property path where to read the input JSON object on the hook object, defaults to <code>result</code></li><li><strong>storePath</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>store</strong>: see description in <a href="/krawler/how-to-use-it/HOOKS.html#common-options">common options</a></li><li><strong>outputType</strong>: the type of output produced by this hook, defaults to <code>intermediate</code></li><li>any option supported by <a href="https://github.com/nodeca/js-yaml#safedump-object---options-" target="_blank" rel="noopener noreferrer">js-yaml<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/krawler/assets/js/4.b5cccee6.js" defer></script><script src="/krawler/assets/js/app.87c66467.js" defer></script>
  </body>
</html>
